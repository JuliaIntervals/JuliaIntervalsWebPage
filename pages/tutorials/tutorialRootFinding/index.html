<!doctype html> <!-- Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes Free for personal and commercial use under the MIT license https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE --> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/atom-one-dark.css"> <style> .hljs td { border-bottom: none; padding-bottom: 0em !important; padding-left: 0.5em !important; padding-right: 0.5em !important; padding-top: 0.2em !important;} </style> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/minimal-mistakes.css"> <link rel=stylesheet  href="/css/adjust.css"> <link rel=stylesheet  href="/css/sidebar.css"> <link rel=stylesheet  href="/css/documentation.css"> <link rel=icon  href="/assets/juliaintervals-logoTest.svg"> <!--[if IE ]> <style> /* old IE unsupported flexbox fixes */ .greedy-nav .site-title { padding-right: 3em; } .greedy-nav button { position: absolute; top: 0; right: 0; height: 100%; } </style> <![endif]--> <title>Interval root finding tutorial</title> <script src="/libs/lunr/lunr.min.js"></script> <script src="/libs/lunr/lunr_index.js"></script> <script src="/libs/lunr/lunrclient.min.js"></script> <body class=layout--single > <div class="masthead sticky"> <div class=masthead__inner-wrap > <div class=masthead__menu > <nav id=site-nav  class=greedy-nav > <a class=site-logo  href="/"><img src="/assets/juliaintervals-lockupTest.svg" alt="julia logo"></a> <form id=lunrSearchForm  name=lunrSearchForm > <input class=search-input  name=q  placeholder="Enter search term" type=text  > <input type=submit  class=search-button  value=Search  formaction="/search/index.html" > </form> <ul class=visible-links > <li class=masthead__menu-item ><a href="/pages/tutorials/" >Tutorials</a> <li class=masthead__menu-item ><a href="/pages/howTo/" >Applications</a> <li class=masthead__menu-item ><a href="/pages/explanations/" >Explanations</a> <li class=masthead__menu-item ><a href="/pages/apiDocs/">API docs</a> <li class=masthead__menu-item ><a href="/pages/faq/">Contributors</a> </ul> <button class="greedy-nav__toggle hidden" type=button > <span class=visually-hidden >Toggle menu</span> <div class=navicon ></div> </button> <ul class="hidden-links hidden"></ul> </nav> </div> </div> </div> <div class=initial-content > <div id=main  role=main > <div class="sidebar sticky"> <div itemscope itemtype="https://schema.org/Person"> <h3><label for=show-menu  class=show-menu >Index</label></h3> <input type=checkbox  id=show-menu  role=button > <div class=menu  id=side-menu > <h2 class=sidebar-title ><a href="/pages/tutorials" class=sidebar-link >Tutorials</a></h2> <ul class=menu-list > <li class="menu-list-item "><a href="/pages/tutorials/tutorialArithmetic/" class="menu-list-link ">IntervalArithmetic.jl</a> <li class="menu-list-item active"><a href="/pages/tutorials/tutorialRootFinding/" class="menu-list-link active">IntervalRootFinding.jl</a> <li class="menu-list-item "><a href="/pages/tutorials/tutorialConstraintProgramming/" class="menu-list-link ">IntervalConstraintProgramming.jl</a> <li class="menu-list-item "><a href="/pages/tutorials/tutorialOptimisation/" class="menu-list-link ">IntervalOptimisation.jl</a> <li class="menu-list-item "><a href="/pages/tutorials/tutorialTaylorModels/" class="menu-list-link ">TaylorModels.jl</a> </ul></div> </div> </div> <div class=franklin-content ><h1 id=interval_root_finding_tutorial ><a href="#interval_root_finding_tutorial">Interval root finding tutorial</a></h1></p> <div class=franklin-toc ><ol><li><a href="#setup">Setup</a><li><a href="#introduction">Introduction</a><li><a href="#basic_usage">Basic Usage</a><li><a href="#explicit_derivatives">Explicit derivatives</a><li><a href="#multidimensional_example">Multidimensional example</a><li><a href="#tolerance">Tolerance</a></ol></div> <p>Download the <a href="/notebooks/tutorials/tutorialRootFinding.ipynb">notebook</a> for this tutorial.</p> <p><h2 id=setup ><a href="#setup">Setup</a></h2> <p>The <code>IntervalRootFinding.jl</code> package can be installed with</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Pkg; Pkg.add(<span class=hljs-string >&quot;IntervalRootFinding&quot;</span>);</code></pre>
<p>Once the package is installed, it can be imported. Note that you will need also the <code>IntervalArithmetic.jl</code> package.</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> IntervalArithmetic, IntervalRootFinding</code></pre>
<h2 id=introduction ><a href="#introduction">Introduction</a></h2>
<p>The <code>IntervalRootFinding.jl</code> can be used to rigorously compute the zeros of a function <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>:</mo><msup><mi mathvariant=double-struck >R</mi><mi>m</mi></msup><mo>→</mo><msup><mi mathvariant=double-struck >R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">f: \mathbb{R}^m\rightarrow\mathbb{R}^n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68889em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord mathbb">R</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >→</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68889em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord mathbb">R</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> over a given interval &#40;or interval box&#41; <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>⊂</mo><msup><mi mathvariant=double-struck >R</mi><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">X\subset\mathbb{R}^m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >⊂</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68889em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord mathbb">R</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span></span></span></span>.</p>
<h2 id=basic_usage ><a href="#basic_usage">Basic Usage</a></h2>
<p>To get started, let&#39;s compute the roots of the simple function <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mn>2</mn><mi>x</mi></mrow><annotation encoding="application/x-tex">f(x)=x^2-2x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.897438em;vertical-align:-0.08333em;"></span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2</span><span class="mord mathdefault">x</span></span></span></span> over the interval <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mo>−</mo><mn>4</mn><mo separator=true >,</mo><mo>−</mo><mn>4</mn><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[-4, -4]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >−</span><span class=mord >4</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >−</span><span class=mord >4</span><span class=mclose >]</span></span></span></span>. To fullfil the task, we can use the function <code>roots</code> from the <code>IntervalRootFinding</code> package which has syntax</p>
<p><code>rts &#61; roots&#40;f, X, method&#41;</code>, <br/>where</p>
<ul>
<li><p><code>f</code> is the function whose roots we want to find</p>

<li><p><code>X</code> is the interval over which we look for the roots</p>

<li><p><code>method</code> is a third optional parameter that specifies what method is used to compute the roots. The following methods are supported: Newton &#40;default&#41;, Krawczyk and Bisection.</p>

</ul>
<pre><code class="julia hljs">f(x) = x^<span class=hljs-number >2</span>-<span class=hljs-number >2</span>x
X = -<span class=hljs-number >4.</span><span class=hljs-number >.4</span>

rts = roots(f, X) <span class=hljs-comment ># using newton method</span></code></pre><pre><code class="plaintext hljs">2-element Array{IntervalRootFinding.Root{IntervalArithmetic.Interval{Float64}},1}:
 Root([1.99999, 2.00001], :unique)
 Root([-1.72982e-09, 1.38862e-09], :unique)</code></pre>
<p>As can be noticed, the result of the function is an array of elements of type <code>Root</code>. Each Root-element has two fields: <code>interval</code>, containing the interval contain a zero of the function, and <code>status</code>, a &quot;label&quot; telling whether the interval is guaranteed to contain a single root &#40;<code>:unique</code>&#41; or whether the interval may possibly contain multiple or zero roots &#40;<code>:unknown</code>&#41;. It is good to notice that only Newton and Krawczyk methods can make some considerations on the uniqueness of the roots. If Bisection method is used, the status of all roots will automatically be unknown, as the following example shows.</p>
<pre><code class="julia hljs">roots(f, X, Bisection)</code></pre><pre><code class="plaintext hljs">4-element Array{IntervalRootFinding.Root{IntervalArithmetic.Interval{Float64}},1}:
 Root([-2.3921e-08, 3.24651e-08], :unknown)
 Root([1.99999, 2.00001], :unknown)
 Root([1.99999, 2], :unknown)
 Root([2, 2.00001], :unknown)</code></pre>
<p>Note also how the Bisection method may return some extra intervals not containing the roots.</p>
<h2 id=explicit_derivatives ><a href="#explicit_derivatives">Explicit derivatives</a></h2>
<p>Both Newton and Krawczyk method need to compute the derivative of the function. This is done under the hood using the <code>ForwardDiff.jl</code> package. You can help the solver by explicitly giving the derivative of the function as a second parameter. This is particularly useful if ForwardDiff is not able to compute the derivative.</p>
<pre><code class="julia hljs">roots(log, x-&gt;<span class=hljs-number >1</span>/x, -<span class=hljs-number >2.</span><span class=hljs-number >.2</span>)</code></pre><pre><code class="plaintext hljs">1-element Array{IntervalRootFinding.Root{IntervalArithmetic.Interval{Float64}},1}:
 Root([0.999999, 1.00001], :unique)</code></pre>
<p>Note that this will &#40;generally&#41; speed up the computations a little, but it will not affect the accuracy of the result</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> BenchmarkTools
<span class=hljs-meta >@btime</span> roots(log, x-&gt;<span class=hljs-number >1</span>/x, -<span class=hljs-number >2.</span><span class=hljs-number >.2</span>)

<span class=hljs-meta >@btime</span> roots(log, -<span class=hljs-number >2.</span><span class=hljs-number >.2</span>)</code></pre><pre><code class="plaintext hljs">  4.243 μs (54 allocations: 4.17 KiB)
  4.714 μs (70 allocations: 4.67 KiB)
1-element Array{IntervalRootFinding.Root{IntervalArithmetic.Interval{Float64}},1}:
 Root([0.999999, 1.00001], :unique)</code></pre>
<h2 id=multidimensional_example ><a href="#multidimensional_example">Multidimensional example</a></h2>
<p>The function <code>roots</code> works also for multidimensional functions <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=double-struck >R</mi><mi>m</mi></msup><mo>→</mo><msup><mi mathvariant=double-struck >R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^m\rightarrow\mathbb{R}^n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68889em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord mathbb">R</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >→</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68889em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord mathbb">R</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>, with a few adjustments:</p>
<ul>
<li><p>the function should return a <code>SVector</code>, an efficient data structure for arrays whose size is known at compile time. SVector requires the package <code>StaticArrays</code>.</p>

<li><p>the function can take as input an array or a tuple of scalars</p>

<li><p>The roots are now searched over an <code>IntervalBox</code></p>

</ul>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> StaticArrays
g( (x, y) ) = SVector(sin(x), cos(y))
X = IntervalBox(-<span class=hljs-number >3.</span><span class=hljs-number >.3</span>, <span class=hljs-number >2</span>)

rts = roots(g, X)</code></pre><pre><code class="plaintext hljs">2-element Array{IntervalRootFinding.Root{IntervalArithmetic.IntervalBox{2,Float64}},1}:
 Root([-1.19115e-21, 1.0588e-22] × [-1.5708, -1.57079], :unique)
 Root([-1.19115e-21, 1.0588e-22] × [1.57079, 1.5708], :unique)</code></pre>
<p>Similarly to 1D, if Newton or Krawczyk method are used, the solver can be helped by explicitly providing the Jacobian, which should be a <code>SMatrix</code></p>
<pre><code class="julia hljs"><span class=hljs-keyword >function</span> dg( (x, y) )
    <span class=hljs-keyword >return</span> SMatrix{<span class=hljs-number >2</span>, <span class=hljs-number >2</span>}(cos(x), <span class=hljs-number >0</span>, <span class=hljs-number >0</span>, -sin(y))
<span class=hljs-keyword >end</span>

<span class=hljs-meta >@btime</span> roots(g, dg, X)
<span class=hljs-meta >@btime</span> roots(g, X)</code></pre><pre><code class="plaintext hljs">  45.901 μs (461 allocations: 25.36 KiB)
  49.001 μs (462 allocations: 25.41 KiB)
</code></pre>
<h2 id=tolerance ><a href="#tolerance">Tolerance</a></h2>
<p>By default, the roots are found with a tolerance of <code>1e-15</code>. This can be changed by giving the solver an extra parameter. A Higher tolerance can significantly speed up the computations. However, as a drawback, more intervals might have an <code>:unknown</code> status. Observe the following example</p>
<pre><code class="julia hljs">h(x) = cos(x) * sin(<span class=hljs-number >1</span> / x)

<span class=hljs-meta >@btime</span> roots(h, <span class=hljs-number >0.05</span>.<span class=hljs-number >.1</span>)</code></pre><pre><code class="plaintext hljs">  42.800 μs (140 allocations: 12.98 KiB)
6-element Array{IntervalRootFinding.Root{IntervalArithmetic.Interval{Float64}},1}:
 Root([0.106103, 0.106104], :unique)
 Root([0.318309, 0.31831], :unique)
 Root([0.0795774, 0.0795775], :unique)
 Root([0.0636619, 0.063662], :unique)
 Root([0.0530516, 0.0530517], :unique)
 Root([0.159154, 0.159155], :unique)</code></pre>
<pre><code class="julia hljs"><span class=hljs-meta >@btime</span> roots(h, <span class=hljs-number >0.05</span>.<span class=hljs-number >.1</span>, Newton, <span class=hljs-number >1e-2</span>)</code></pre><pre><code class="plaintext hljs">  24.500 μs (101 allocations: 10.20 KiB)
6-element Array{IntervalRootFinding.Root{IntervalArithmetic.Interval{Float64}},1}:
 Root([0.317179, 0.319299], :unique)
 Root([0.157209, 0.165989], :unknown)
 Root([0.104739, 0.107542], :unknown)
 Root([0.0515382, 0.0531049], :unique)
 Root([0.0785458, 0.0797755], :unknown)
 Root([0.0570253, 0.0641614], :unknown)</code></pre>
<pre><code class="julia hljs"><span class=hljs-meta >@btime</span> roots(h, <span class=hljs-number >0.05</span>.<span class=hljs-number >.1</span>, Newton, <span class=hljs-number >1e-1</span>)</code></pre><pre><code class="plaintext hljs">  9.000 μs (46 allocations: 3.92 KiB)
3-element Array{IntervalRootFinding.Root{IntervalArithmetic.Interval{Float64}},1}:
 Root([0.107541, 0.165989], :unknown)
 Root([0.283803, 0.3555], :unknown)
 Root([0.0499999, 0.107542], :unknown)</code></pre>

<div class=page-foot >
  <div class=copyright >
    &copy; JuliaIntervals. Last modified: February 04, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
  </div>
</div>
</div>

      </div> 
    </div>   

    <div class=page__footer >
      <footer>
        
        
        <div class=page__footer-follow >
          <ul class=social-icons >
            <li><strong>Follow:</strong>
            <li><a href="https://github.com/JuliaIntervals" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden=true ></i> GitHub</a>
          </ul>
        </div>
        <div class=page__footer-copyright >&copy; JuliaIntervals. Powered by <a href="https://github.com/tlienart/Franklin.jl">Franklin</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel=nofollow >Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="/libs/minimal-mistakes/main.min.js"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin=anonymous ></script>